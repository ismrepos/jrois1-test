os: linux
#os: windows
services:
  - mysql
language: node_js
node_js:
- '10'
env:
  global:
    - MOZ_HEADLESS=1
addons:
  chrome: stable
  firefox: latest
  ssh_known_hosts: 140.238.39.160
sudo: required
cache: npm
branches:
  only:
  - master
before_install:
# Linux
#- openssl aes-256-cbc -K $encrypted_d2018b1f08ea_key -iv $encrypted_d2018b1f08ea_iv
#  -in deploy_rsa.enc -out /tmp/deploy_rsa -d
- cd Rois/test/
- mysql -e 'CREATE DATABASE rois;'
- mysql -utravis rois < ./utils/data/localhost_rois_init.sql
- mysql -utravis rois -e 'SELECT count(*) FROM TDAT_RIYOSYA;'
# Windows
#- choco install jdk8
#- export PATH=$PATH:"C:\Program Files\Java\jdk1.8.0_231\bin"
#- java -version
#- cd Rois/test/

install:
- npm install

# Linux
before_script:
- selenium-standalone start &
- sleep 10
script: "./node_modules/.bin/wdio wdio_linux.conf.js"

# Windows
#before_script: 
#- export PATH=$PATH:".\node_modules\.bin"
#- selenium-standalone start &
#- sleep 30
#script: "./node_modules/.bin/wdio wdio_win.conf.js"

#before_deploy:
#- eval "$(ssh-agent -s)" 
#- chmod 600 /tmp/deploy_rsa
#- ssh-add /tmp/deploy_rsa

#deploy:
#  provider: script
#  skip_cleanup: true
#  script: scp -i /tmp/deploy_rsa $TRAVIS_BUILD_DIR/Rois/test/test.txt opc@140.238.39.160:/home/opc/Downloads
#  on:
#    branch: master
